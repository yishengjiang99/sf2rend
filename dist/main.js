(()=>{"use strict";var e,t,n={},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,a),o.exports}function o(e,t={},n=""){const r=document.createElement(e);for(const e in t)e.match(/on(.*)/)?r.addEventListener(e.match(/on(.*)/)[1],t[e]):r.setAttribute(e,t[e]);return(Array.isArray(n)?n:[n]).forEach((e=>{"string"==typeof e?r.innerHTML+=e:r.append(e)})),r}function s(e,t={},n=[]){var r=document.createElementNS("http://www.w3.org/2000/svg",e);for(var a in t)"xlink:href"==a?r.setAttributeNS("http://www.w3.org/1999/xlink","href",t[a]):r.setAttribute(a,t[a]);return(Array.isArray(n)?n:[n]).forEach((e=>r.append(e))),r}a.m=n,a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,n)=>(a.f[n](e,t),t)),[])),a.u=e=>e+".js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="sf2rend:",a.l=(n,r,o,s)=>{if(e[n])e[n].push(r);else{var i,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+o){i=u;break}}i||(c=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+o),i.src=n),e[n]=[r];var p=(t,r)=>{i.onerror=i.onload=null,clearTimeout(f);var a=e[n];if(delete e[n],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((e=>e(r))),t)return t(r)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),c&&document.head.appendChild(i)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={179:0};a.f.j=(t,n)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,a)=>r=e[t]=[n,a]));n.push(r[2]=o);var s=a.p+a.u(t),i=new Error;a.l(s,(n=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",i.name="ChunkLoadError",i.type=o,i.request=s,r[1](i)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[s,i,c]=n,l=0;for(r in i)a.o(i,r)&&(a.m[r]=i[r]);for(c&&c(a),t&&t(n);l<s.length;l++)o=s[l],a.o(e,o)&&e[o]&&e[o][0](),e[s[l]]=0},n=self.webpackChunksf2rend=self.webpackChunksf2rend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),HTMLElement.prototype.attachTo=function(e){return e.append(this),this},HTMLElement.prototype.wrapWith=function(e){const t=o(e);return t.append(this),t};let i,c,l=null;class d extends AudioWorkletNode{static async init(e){await e.audioWorklet.addModule(document.location.pathname+"./spin/spin-proc.js"),l||(l=await fetch(document.location.pathname+"./spin/spin.wasm").then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))))}static alloc(e){return i||(i=new d(e)),i}constructor(e){const t=new SharedArrayBuffer(384*Uint32Array.BYTES_PER_ELEMENT+4096*Float32Array.BYTES_PER_ELEMENT);super(e,"spin-proc",{numberOfInputs:16,numberOfOutputs:16,outputChannelCount:[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],processorOptions:{sb:t,wasm:l}}),this.sb=t,this.f32view=new Float32Array(this.sb,0,384),this.u32view=new Uint32Array(this.sb,0,384);const n=384*Uint32Array.BYTES_PER_ELEMENT;this.output_floats=new Float32Array(this.sb,n),this.fetchWorker=function(e){const t=new Worker("./dist/fetchworker.js");return t.postMessage({destination:e},[e]),t}(this.port)}keyOn(e,t,n,r){let a=0;const o=this.u32view;for(;0!=o[a];)a+=12;let s=t.shdr.loops;1==t.SampleModes&&s[1]-s[0]>8||(s=[0,t.shdr.byteLength/2]),o.set(new Uint32Array([2,e,t.SampleId,s[0],s[1]])),this.f32view.set(new Float32Array([9==e?1:t.calcPitchRatio(n,this.context.sampleRate),0,.2,1/this.context.sampleRate/Math.pow(2,t.VolEnvAttack/1200)]),a+5)}async shipProgram(e){return async function(e,t){const n=Object.values(t.shdrMap).sort(((e,t)=>e.sampleId<t.sampleId));let r=null,a=[];for(const o of n)null!=r&&r+1!=o.sampleId&&a.length>0&&(e.postMessage({url:t.url,smpls:a}),r=null,a=[]),r=o.SampleId,a.push({sampleId:r,range:o.range});a.length>0&&e.postMessage({url:t.url,smpls:a})}(this.fetchWorker,e,this.port),await new Promise((e=>{this.fetchWorker.addEventListener("message",(function({data:t}){t.ack&&e(t.cak)}),{once:!0})}))}handleMsg(e){console.log(e.data)}get outputSnapshot(){return this.output_floats}}class u extends AudioWorkletNode{static async init(e){await e.audioWorklet.addModule("lpf/lpf.proc.js").catch((e=>console.trace(e))),c||(c=await p())}constructor(e,t){t>.5*e.sampleRate&&(t=.5*e.sampleRate),super(e,"lpf",{numberOfInputs:16,numberOfOutputs:16,processorOptions:{outputChannelCount:[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],wasmbin:c,filterFC:t/e.sampleRate}})}set frequency(e){this.port.postMessage(e/this.context.sampleRate)}modulate(e){}}const p=async()=>new Uint8Array(await fetch("lpf/lpf.wasm").then((e=>e.arrayBuffer())));class f{constructor(e,t,n,r){this.nameLabel=e.querySelector(".name"),this.meters=e.querySelectorAll("meter"),this.sliders=e.querySelectorAll("input[type='range']"),this.led=e.querySelector("input[type=checkbox]"),this.canc=e.querySelector(".canvasContainer"),this.keys=Array.from(t.querySelectorAll("a")),this.keys.forEach(((e,t)=>{var a=0;const o=e.getAttribute("midi");e.onmousedown=()=>{a++,r([144|n,o,111]),e.addEventListener("mouseup",(()=>a-- >0&&r([128|n,o,111])),{once:!0}),e.addEventListener("mouseleave",(()=>r([128|n,o,111])),{once:!0})}})),this.polylines=Array.from(e.querySelectorAll("polyline"))}set name(e){this.nameLabel.innerHTML=e}set midi(e){this.meters[0].value=e}set velocity(e){this.meters[1].value=e}set active(e){e?this.led.setAttribute("checked","checked"):this.led.removeAttribute("checked")}set env1({phases:[e,t,n,r],peak:a}){const o=[[0,0],[e,1],[e+t,(100-n)/100],[e+t+r,0]].map((([e,t])=>[12*e,.8*(1-t)*40].join(","))).join(" ");this.polylines[0].setAttribute("points",o)}get canvasContainer(){return this.canc}set zone(e){}}const m=["StartAddrOfs","EndAddrOfs","StartLoopAddrOfs","EndLoopAddrOfs","StartAddrCoarseOfs","ModLFO2Pitch","VibLFO2Pitch","ModEnv2Pitch","FilterFc","FilterQ","ModLFO2FilterFc","ModEnv2FilterFc","EndAddrCoarseOfs","ModLFO2Vol","Unused1","ChorusSend","ReverbSend","Pan","Unused2","Unused3","Unused4","ModLFODelay","ModLFOFreq","VibLFODelay","VibLFOFreq","ModEnvDelay","ModEnvAttack","ModEnvHold","ModEnvDecay","ModEnvSustain","ModEnvRelease","Key2ModEnvHold","Key2ModEnvDecay","VolEnvDelay","VolEnvAttack","VolEnvHold","VolEnvDecay","VolEnvSustain","VolEnvRelease","Key2VolEnvHold","Key2VolEnvDecay","Instrument","Reserved1","KeyRange","VelRange","StartLoopAddrCoarseOfs","Keynum","Velocity","Attenuation","Reserved2","EndLoopAddrCoarseOfs","CoarseTune","FineTune","SampleId","SampleModes","Reserved3","ScaleTune","ExclusiveClass","OverrideRootKey","Dummy"];function h(e){const t=new Int16Array(e),n=new Float32Array(e.byteLength/2);for(let e=0;e<t.length;e++)n[e]=t[e]/65535;return n}function y(e){return[e.canvas.getAttribute("width")?parseInt(e.canvas.getAttribute("width")):480,e.canvas.getAttribute("height")?parseInt(e.canvas.getAttribute("height")):320]}function g(e){if(!e)return;const t=e,[n,r]=y(t);t.clearRect(0,0,n,r),t.fillStyle="black",t.fillRect(0,0,n,r)}function w(e,t){g(e);const[n,r]=y(e);let a=0,o=0,s=n/t.length;for(let e=1;e<t.length;e++)a=t[e]>a?t[e]:a;e.beginPath(),e.lineWidth=1,e.strokeStyle="rbga(0xff,0xff,0x00,.5)",e.lineWidth=2,e.strokeStyle="white",e.moveTo(0,r/2);for(let n=1;n<t.length;n++)o+=s,e.lineTo(o,r/2-r/4*t[n]);e.stroke(),e.restore(),e.font="1em Arial"}function b(e={}){const{width:t,height:n,container:r,title:a}=Object.assign({container:document.body,title:"",width:480,height:320},e),o=document.createElement("canvas");o.setAttribute("width",`${t}`),o.setAttribute("height",`${n}`);const s=o.getContext("2d");s.lineWidth=2,s.strokeStyle="white",s.fillStyle="black",s.font="2em";const i=v("div",{},[a?v("h5",{},a):"",o]);return r.append(i),o.ondblclick=()=>g(s),s}function v(e,t={},n=""){const r=document.createElement(e);for(const e in t)e.match(/on(.*)/)?r.addEventListener(e.match(/on(.*)/)[1],t[e]):r.setAttribute(e,t[e]);return(Array.isArray(n)?n:[n]).forEach((e=>{"string"==typeof e?r.innerHTML+=e:r.append(e)})),r}HTMLElement.prototype.attachTo=function(e){return e.append(this),this},HTMLElement.prototype.wrapWith=function(e){const t=v(e);return t.append(this),t};var A=["Name","Url","LastModified","Etag","Size","ContentType","ContentEncoding","ContentLanguage"];function S(e="https://grep32bit.blob.core.windows.net/midi?resttype=container&comp=list"){return new Promise(((t,n)=>{const r=new XMLHttpRequest;r.open("GET",e),r.responseType="document",r.send(),r.onload=function(){if(r.responseXML){const e=Array.from(r.responseXML.querySelectorAll("Blob"));t(e.map((function(e){var t=new Map;return A.forEach((function(n){t.set(n,e.querySelector(n).textContent)})),t})).sort(((e,t)=>new Date(e.LastModified)<new Date(t.lastModified)?-1:1)))}},r.onerror=n,r.ontimeout=n}))}function k(e,t,n){e.ctx;const r=e.spinner,a=e.egs[t];let o,s,i;return{get pid(){return i},set midicc(e){o=e},set program({pg:e,pid:t,bankId:r,name:a}){s=e,i=t,n.name=a||"pid "+t+" bid "+r},keyOn(e,i){console.assert(null!=s);const c=s.filterKV(e,i)[0];a.midiState=o,a.zone=c,r.keyOn(t,c,e,i),a.keyOn(0),requestAnimationFrame((()=>{n.velocity=i,n.key=e}))},keyOff(e,t){a.keyOff(0)}}}function E(e){const t=new GainNode(e,{gain:0});let n,r,a,o,s,i,c,l,d;return{set zone(e){!function(e){[n,r,a,o,s]=[e.VolEnvDelay,e.VolEnvAttack,e.VolEnvHold,e.VolEnvDecay,e.VolEnvRelease].map((e=>-1==e||e<=-12e3?.001:Math.pow(2,e/1200))),c=Math.pow(10,e.VolEnvSustain/-200),d=e}(e)},set midiState(e){l=e},keyOn(c){t.gain.cancelScheduledValues(e.baseLatency);const u=Math.pow(10,-.005*d.Attenuation),p=l[7]/128,f=l[11]/128;return i=1*u*p*f,t.gain.linearRampToValueAtTime(i,n+r),{phases:[n,r,a,o,s],peak:i}},keyOff(){t.gain.cancelScheduledValues(0),t.gain.linearRampToValueAtTime(0,s)},gainNode:t}}const M=document.querySelector("#sf2list"),O=document.querySelector("#channelContainer"),{stdout:T}=function(e=o("pre",{style:"width:30em;min-height:299px;scroll-width:0;max-height:299px;overflow-y:scroll"})){const t=[];let n="",r="";return{stderr:e=>{n=e,r=e},stdout:r=>{t.push((performance.now()/1e3).toFixed(3)+": "+r),t.length>100&&t.shift(),e.innerHTML=n+"\n"+t.join("\n"),e.scrollTop=e.scrollHeight},infoPanel:e,errPanel:o("span")}}(document.querySelector("pre")),R=document.querySelector("footer"),L=document.querySelector("progress"),x=[];let P;async function C(e,t,n,r){const a=[],o=new Uint8Array(2048),s=[];for(let t=0;t<16;t++){a[t]=k(e,t,n[t]),a[t].midicc=o.subarray(128*t,128*t+128),o[128*t+7]=100,o[128*t+11]=127,o[128*t+10]=64;const r=n[t].canvasContainer;s[t]=b({container:r,height:r.clientHeight,width:r.clientWidth})}return r.onmessage((function(e){const[t,n,r]=e,s=t>>4,i=15&t,c=127&n,l=127&r;switch(T("midi msg channel:"+i+" cmd "+s.toString(16)),s){case 11:o[128*i+c]=l;break;case 12:const e=c,t=9==i?128:0;e!=a[i].pid&&_loadProgram(i,e,t);break;case 8:a[i].keyOff(c,l);break;case 9:0==l?a[i].keyOff(c,l):(T("playnote "+c+" for "+i),a[i].keyOn(c,l))}})),{channels:a,ccs:o,canvases:s}}!async function(e,t){const n=function(){const e=[];let t;return{onmessage(e){t=e},postMessage(n){e.push(n),t&&t(e.shift())}}}(),r=function(e,t){t=t.postMessage;const n=[],r=o("div",{border:1,style:"display:grid;grid-template-columns:1fr; margin-bottom:10px;background:#333333;grid-row-gap:20px;"});for(let e=0;e<16;e++){const a=o("div",{class:"keyboards",style:"display:none"},(55,69,Array.from(function*(e,t){for(;e<69;)yield e++}(55))).map((e=>o("a",{midi:e},[e," "])))),i=o("div",{class:"attrs",onmouseenter:e=>{e.target.querySelector(".keyboards").style.display="block"},onmouseleave:e=>{e.target.querySelector(".keyboards").style.display="none"},style:"display:grid; grid-template-columns:1fr 1fr 1fr"},[o("div",{style:"display:grid; grid-template-columns:1fr"},[o("span",{class:"name"},["channel "+e]),o("input",{type:"checkbox"}),o("meter",{min:0,max:127,step:1,aria:"key"}),o("meter",{min:0,max:127,step:1,aria:"vel"})]),o("div",{style:"display:grid;grid-template-columns:2fr 2fr"},[o("label",{for:"exp_vol"},"volume"),o("input",{min:0,max:127,step:1,type:"range"}),o("label",{for:"pan"},"pan"),o("input",{min:0,max:127,step:1,type:"range"}),o("label",{for:"expression"},"expression"),o("input",{min:0,max:127,step:1,type:"range"})]),o("div",{style:"display:grid; grid-template-columns:1fr 4fr;background-color:grey"},[s("svg",{style:"width:80;height:40; display:inline;",viewBox:"0 0 80 40"},[s("polyline",{fill:"red",stroke:"black"})]),o("div",{class:"canvasContainer"})]),a]);n.push(new f(i,a,e,t)),i.attachTo(r),a.attachTo(i)}return r.attachTo(e),n}(O,n);if(P=await async function(e,{onHeader:t,onSample:n,onZone:r}={}){let o,s,i,c,l;c=e;const d=await a.e(35).then(a.bind(a,35)),u=await d.default(),{pdtaBuffer:p,sdtaStart:f}=await async function(e){const t=await(await fetch(e,{headers:{Range:"bytes=0-6400"}})).arrayBuffer(),[n,r]=function(e){const t=function(e){const t=new Uint8Array(e);let n=0;function r(){return t[n++]}function a(e){const r=t.subarray(n,n+e);return n+=e,r}const o=()=>r()|r()<<8;return{skip:e=>{n+=e},get8:r,get16:o,getS16:()=>{const e=o();return 32768&e?-65536+e:e},readN:e=>{const r=t.slice(n,e);return n+=e,r},read32String:()=>a(4),varLenInt:function(){let e=r();for(;128&e;)e=r();return e},get32:function(){return r()|r()<<8|r()<<16|r()<<24},readNString:e=>a(e),get offset(){return n},set offset(e){n=e}}}(new Uint8Array(e)),[n,r,a,o]=[t.readNString(4),t.get32(),t.readNString(4),t.readNString(4)];let s=t.get32();console.log(t.readNString(4),r,o,t.offset),console.log(s,t.offset);const i=[];for(console.assert(s<1e4);s>=8;){const[e,n]=[t.readNString(4),t.get32()];i.push({section:e,text:t.readNString(n)}),s=s-8-n}return t.readNString(4),[i,t]}(t),a=r.get32(),o=r.offset+8,s=o+a+4,i={headers:{Range:"bytes="+s+"-"}};return{nsamples:(s-o)/2,sdtaStart:o,infos:n,pdtaBuffer:new Uint8Array(await(await fetch(e,i)).arrayBuffer())}}(e);function m(){}i=f;const h=u._malloc(p.byteLength);u.onHeader=t||m,u.onSample=()=>n||m,u.onZone=r||m,u.HEAPU8.set(p,h);const y=u._loadpdta(h);return s=u._shdrref(h),l=new Uint32Array(u.HEAPU32.buffer,u._presetRef(),255),o=u.HEAPU8.buffer.slice(0,y),{pdtaRef:h,heapref:new WeakRef(o),presetRefs:l,heap:o,shdrref:s,sdtaStart:f,url:e}}("https://dsp.grepawk.com/sf2rend/file.sf2",{onHeader(e,t,n){M.append(o("a",{class:"chlink",pid:e,bid:t},[n]).wrapWith("li")),x[e|t]=n}}),!P.presetRefs)return;const i=await async function(){const e=new AudioContext({sampleRate:44100});await d.init(e);const t=new d(e),n=new AudioBufferSourceNode(e,{buffer:new AudioBuffer({numberOfChannels:1,sampleRate:e.sampleRate,length:1}),loop:!0});n.buffer.getChannelData(0)[0]=1,await u.init(e);const r=new u(e,.45*e.sampleRate),a=[],o=new ChannelMergerNode(e,{numberOfInputs:16}),s=new GainNode(e,{gain:1});for(let r=0;r<16;r++)a[r]=E(e),n.connect(a[r].gainNode).connect(t,0,r).connect(o,r);return n.start(),o.connect(e.destination),document.addEventListener("mousedown",(async()=>await e.resume()),{once:!0}),{ctx:e,spinner:t,lpf:r,egs:a,masterMixer:s}}(),c=await C(i,0,r,n),{presets:l,totalTicks:p,midiworker:y}=await("https://grep32bit.blob.core.windows.net/midi/Britney_Spears_-_Baby_One_More_Time.mid",new Promise(((e,t)=>{const n=new Worker("./dist/midiworker.js#https://grep32bit.blob.core.windows.net/midi/Britney_Spears_-_Baby_One_More_Time.mid",{type:"module"});n.addEventListener("message",(({data:{totalTicks:t,presets:r}})=>e({midiworker:n,totalTicks:t,presets:r})),{once:!0}),n.onerror=t,n.onmessageerror=t})));async function g(e,t,n){const r=function({url:e,presetRefs:t,heap:n,shdrref:r,sdtaStart:a},o,s=0){const i=t[o|s],c=[],l={};for(let t=i,n=d(t);n&&-1!=n.SampleId;n=d(t+=120)){const t=n.SampleId;l[t]||(l[t]=u(n.SampleId),l[t].data=async()=>l[t].pcm||await fetch(e,{headers:{Range:`bytes=${l[t].range.join("-")}`}}).then((e=>e.arrayBuffer())).then((e=>(l[t].pcm=h(e),l[t].pcm)))),c.push({...n,get shdr(){return l[n.SampleId]},get pcm(){return l[n.SampleId].data()},calcPitchRatio(e,t){const r=(100*e-(100*(n.OverrideRootKey>-1?n.OverrideRootKey:l[n.SampleId].originalPitch)+100*n.CoarseTune+1*n.FineTune))/1200;return Math.pow(2,r)*(l[n.SampleId].sampleRate/t)}})}function d(e){return function(e,t){var n={ref:e};for(let e=0;e<60;e++)n[m[e]]="VelRange"==m[e]||"KeyRange"==m[e]?{hi:(32512&t[e])>>8,lo:127&t[e]}:t[e];return n}(e,new Int16Array(n,e,60))}function u(t){const o=r+46*t,s=n.slice(o,o+46),[i,c,l,d,u]=new Uint32Array(s,20,5),[p]=new Uint8Array(s,40,1);return{nsamples:c-i+1,range:[a+2*i,a+2*c+1],loops:[l-i,d-i],SampleId:t,sampleRate:u,originalPitch:p,url:e,hdrRef:o}}return{zMap:c,preload:async function(){await Promise.all(Object.keys(l).map((e=>l[e].data())))},shdrMap:l,url:e,zref:i,filterKV:function(e,t){return c.filter((n=>(-1==t||n.VelRange.lo<=t&&n.VelRange.hi>=t)&&(-1==e||n.KeyRange.lo<=e&&n.KeyRange.hi>=e)))}}}(P,t,n);c.channels[e].program={pg:r,pid:t,bankId:n,name:x[n|t]},await i.spinner.shipProgram(r)}L.setAttribute("max",p),await g(0,0,0),await g(9,0,128);for await(const e of async function*(e){for(const t of e){const{pid:e,channel:n,t:r}=t;if(r>0)continue;const a=9==n?128:0;yield await g(n,e,a)}}(l));let b=0;M.onclick=({target:e})=>g(b++,e.getAttribute("pid"),e.getAttribute("bankId")),function(e,t,{timeslide:n,cmdPanel:r,playlist:a}){e.addEventListener("message",(e=>{e.data.channel?t.postMessage(e.data.channel):e.data.tick&&(n.value=e.data.tick)})),o("button",{class:"cmd",cmd:"start"},"start").attachTo(r),o("button",{class:"cmd",cmd:"pause"},"pause").attachTo(r),o("button",{class:"cmd",cmd:"rwd",amt:"rwd"},"rwd").attachTo(r),r.querySelectorAll("button.cmd").forEach((t=>t.addEventListener("click",(t=>e.postMessage({cmd:t.target.getAttribute("cmd")})))))}(y,n,{timeslide:L,cmdPanel:R,playlist:o("div",{},await S())}),async function(e){const t=await navigator.requestMIDIAccess(),n=Array.from(t.inputs.values());Array.from(t.outputs.values());n.forEach((t=>{t.onmidimessage=({data:t,timestamp:n})=>{e.postMessage(t)}}))}(n),requestAnimationFrame((function e(){for(let e=0;e<16;e++)i.egs[e].gainNode.gain.value>1e-5&&w(c.canvases[e],i.spinner.outputSnapshot.subarray(128*e,128*e+128));requestAnimationFrame(e)}))}(),window.onerror=(e,t,n,r,a)=>{document.querySelector("#debug").innerHTML=JSON.stringify([e,t,n,r,a])}})();